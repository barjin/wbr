{
	"meta":{
	   "params":[
		  "Carrier",
		  "From",
		  "To"
	   ]
	},
	"workflow":[
	   {
		  "name": "acceptCookies",
		  "where":{
			 "selectors":[
				"button:text-matches(\"(accept|agree|souhlasím|allow)\", \"i\")"
			 ]
		  },
		  "what":[
			 {
				"type":"click",
				"params":[
				   "button:text-matches(\"(accept|agree|souhlasím|allow)\", \"i\")"
				]
			 }
		  ]
	   },
	   {
		"name": "waitForAsyncLoad",
		"where":{
			"selectors": [
				":text-matches(\"(searching|loading)\",\"i\")"
			]
		},
		"what": [
			{
				"type": "waitForTimeout",
				"params": [
					2000
				]
			}
		]
	   },
	   {
		  "name": "FlixBus Hack",
		  "where":{
			  "$or":[
				{"url": "https://global.flixbus.com/"},
				{"url": "https://www.flixbus.cz/"},
				{"url": "https://www.flixbus.de/"}
			  ],
			  "selectors": [
				"[data-e2e*=departure] input[placeholder]",
				"[data-e2e*=arrival] input[placeholder]"
			  ]		 
		  },
		  "what":[
			 {
				"type":"fill",
				"params":[
				  "[data-e2e*=departure] input[placeholder]",
				  {
					  "$param": "From"
				  }
				]
			 },
			 {
				"type":"fill",
				"params":[
				  "[data-e2e*=departure] input[placeholder]",
				  {
					  "$param": "From"
				  }
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				  "ArrowDown"
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				  "Enter"
				]
			 },
			 {
				"type":"fill",
				"params":[
				  "[data-e2e*=arrival] input[placeholder]",
				  {
					  "$param": "To"
				  }
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				  "ArrowDown"
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				  "Enter"
				]
			 },
			 {
				"type":"click",
				"params":[
					"button[class*=primary]"
				]
			 }
		  ]
	   },
	   {
		"name": "Generic Form filler",
		  "where":{
			 "selectors":[
				"input[name*=from]:not([type=hidden]),input[id*=from]:not([type=hidden]), [id*=from] input:not([type=hidden]), [class*=from] input:not([type=hidden])"
			 ]
		  },
		  "what":[
			 {
				"type":"fill",
				"params":[
					"input[name*=from]:not([type=hidden]),input[id*=from]:not([type=hidden]), [id*=from] input:not([type=hidden]), [class*=from] input:not([type=hidden])",
				   {
					  "$param":"From"
				   }
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				   "Tab"
				]
			 },
			 {
				"type":"keyboard.insertText",
				"params":[
				   {
					  "$param":"To"
				   }
				]
			 },
			 {
				"type":"waitForTimeout",
				"params":[
				   1000
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				   "Enter"
				]
			 },
			 {
				"type":"keyboard.press",
				"params":[
				   "Enter"
				]
			 },
			 {
				"type":"waitForTimeout",
				"params":[
				   2000
				]
			 }
		  ]
	   },
	   {
		  "name": "navigateToPage",
		  "where":{
			 "url": "about:blank"
		  },
		  "what":[
			 {
				"type":"goto",
				"params":[
				   {
					  "$param":"Carrier"
				   }
				]
			 },
			 {
				"type":"waitForLoadState"
			 },
			 {
				"type":"waitForTimeout",
				"params":[
				   3000
				]
			 }
		  ]
	   },
	   {
		  "name": "screenshot",
		  "where":{
			  "$before": "screenshot"
		  },
		  "what":[
			 {
				"type":"waitForLoadState",
				"params":[
				   "networkidle"
				]
			 },
			 {
				"type":"screenshot",
				"params":[
				   {
					   "path": "screenshot_tickets.png",
					   "fullPage": true
				   }
				]
			 }
		  ]
	   }
	]
 }